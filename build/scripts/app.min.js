!function(){"use strict";var e=angular.module("lgApp",["ngCookies","ngResource","ngSanitize","ngRoute","ui.grid","ui.grid.selection"]);e.config(["$routeProvider",function(e){e.when("/",{controller:"homeController",templateUrl:"modules/home/homeTemplate.html"}).when("/lifegroup/:slug",{controller:"lifegroupController",templateUrl:"modules/lifegroup/lifegroupTemplate.html"}).otherwise({redirectTo:"/"})}]).value("localStorage",window.localStorage).value("moment",window.moment).value("_",window._)}(),function(){"use strict";angular.module("lgApp").constant("lgConfig",{agesArr:[{min:0,max:100,title:"All Ages"},{min:20,max:39,title:"20s/30s"}]})}(),function(){"use strict";angular.module("lgApp").service("lgService",["$http",function(e){var t="http://daytonave.org/api";this.getLifegroups=function(){var o=[];return e.get(t+"/get_posts/?post_type=page").then(function(e){var t=e.data;return _.forEach(t.posts,function(e){e.custom_fields.isLifegroup&&o.push(e)}),o})},this.getLifegroupBySlug=function(o){return e.get(t+"/get_page/?slug=lifegroups/"+o)}}])}(),function(){"use strict";angular.module("lgApp").controller("homeController",["$scope","$location","lgService","uiGridConstants","lgConfig","localStorage","moment",function(e,t,o,l,i,r,n){var a={},s=r.getItem("lifegroups");e.lifegroups=[],e.contentReady=!1,e.gridOptions={enableRowSelection:!0,enableRowHeaderSelection:!1,enableHorizontalScrollbar:l.scrollbars.NEVER,enableVerticalScrollbar:l.scrollbars.NEVER,multiSelect:!1,columnDefs:[{field:"title",enableFiltering:!1},{field:"ages",enableFiltering:!1},{field:"day",enableFiltering:!1},{field:"time",enableFiltering:!1},{field:"campus",enableFiltering:!1}],data:[],onRegisterApi:function(o){e.gridApi=o,o.selection.on.rowSelectionChanged(e,function(e){t.path("/lifegroup/"+e.entity.slug)})}};var g=function(){_.forEach(e.lifegroups,function(t){var o=_.result(_.find(i.agesArr,{min:parseInt(t.custom_fields.lgAgeMin),max:parseInt(t.custom_fields.lgAgeMax)}),"title"),l=t.custom_fields.lgStartTime[0].split(":")[0].length>1?"1970-01-01T"+t.custom_fields.lgStartTime[0]:"1970-01-01T0"+t.custom_fields.lgStartTime[0];e.gridOptions.data.push({id:t.id,title:t.title,ages:o,day:t.custom_fields.lgDay[0],time:n.utc(l).format("h:mma"),campus:"true"===t.custom_fields.lgIsOffCampus[0]?"Off Campus":"On Campus",slug:t.slug})})},u=function(){o.getLifegroups().then(function(t){e.lifegroups=t;var o={timeStamp:n.utc().toDate(),data:t};r.setItem("lifegroups",JSON.stringify(o)),g(),e.contentReady=!0})};if(s)try{a=JSON.parse(s);var c=n.utc().diff(n.utc(a.timeStamp));n.duration(c).asMinutes()>15?(console.log("More than 15 minutes has passed since retrieving data. Retrieve from API instead."),r.removeItem("lifegroups"),u()):(e.lifegroups=a.data,console.log("lifegroups retrieved from local storage")),g()}catch(f){console.log("Error parsing lifegroups. Retrieving from API"),r.removeItem("lifegroups"),u()}finally{e.contentReady=!0}else console.log("lifegroups retrieved from API"),u()}])}(),function(){"use strict";angular.module("lgApp").controller("lifegroupController",["$scope","$routeParams","$location","lgService",function(e,t,o,l){var i={},r=window.localStorage.getItem(t.slug);e.lifegroup={},e.contentReady=!1;var n=function(){l.getLifegroupBySlug(t.slug).then(function(o){e.lifegroup=o.data.page;var l={timeStamp:moment.utc().toDate(),data:o};window.localStorage.setItem(t.slug,JSON.stringify(l)),e.contentReady=!0})};if(r)try{i=JSON.parse(r);var a=moment.utc().diff(moment.utc(i.timeStamp));moment.duration(a).asMinutes()>15?(console.log("More than 15 minutes has passed since retrieving data. Retrieve from API instead."),window.localStorage.removeItem(t.slug),n()):(e.lifegroup=i.data.data.page,console.log("lifegroup retrieved from local storage"))}catch(s){console.log("Error parsing lifegroup. Retrieving from API"),window.localStorage.removeItem(t.slug),n()}finally{e.contentReady=!0}else console.log("lifegroup retrieved from API"),n();e.navigateHome=function(){o.path("/")}}])}(),function(){"use strict";angular.module("lgApp").controller("navController",["$scope","$location",function(e,t){e["goto"]=function(e){t.path(e)}}])}(),function(){"use strict";angular.module("lgApp").directive("lgNavigation",[function(){return{restrict:"E",templateUrl:"modules/navigation/navTemplate.html",controller:"navController"}}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImxnQ29uZmlnLmpzIiwiY29tbW9uL2xnU2VydmljZS5qcyIsImhvbWUvaG9tZUNvbnRyb2xsZXIuanMiLCJsaWZlZ3JvdXAvbGlmZWdyb3VwQ29udHJvbGxlci5qcyIsIm5hdmlnYXRpb24vbmF2Q29udHJvbGxlci5qcyIsIm5hdmlnYXRpb24vbmF2RGlyZWN0aXZlLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJjb250cm9sbGVyIiwidGVtcGxhdGVVcmwiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwidmFsdWUiLCJ3aW5kb3ciLCJsb2NhbFN0b3JhZ2UiLCJtb21lbnQiLCJfIiwiY29uc3RhbnQiLCJhZ2VzQXJyIiwibWluIiwibWF4IiwidGl0bGUiLCJzZXJ2aWNlIiwiJGh0dHAiLCJiYXNlVXJsIiwidGhpcyIsImdldExpZmVncm91cHMiLCJsaWZlZ3JvdXBzIiwiZ2V0IiwidGhlbiIsInJlcyIsInBhZ2VzIiwiZGF0YSIsImZvckVhY2giLCJwb3N0cyIsInBhZ2UiLCJjdXN0b21fZmllbGRzIiwiaXNMaWZlZ3JvdXAiLCJwdXNoIiwiZ2V0TGlmZWdyb3VwQnlTbHVnIiwic2x1ZyIsIiRzY29wZSIsIiRsb2NhdGlvbiIsImxnU2VydmljZSIsInVpR3JpZENvbnN0YW50cyIsImxnQ29uZmlnIiwidG1wTGlmZWdyb3VwcyIsImxvY2FsTGlmZWdyb3VwcyIsImdldEl0ZW0iLCJjb250ZW50UmVhZHkiLCJncmlkT3B0aW9ucyIsImVuYWJsZVJvd1NlbGVjdGlvbiIsImVuYWJsZVJvd0hlYWRlclNlbGVjdGlvbiIsImVuYWJsZUhvcml6b250YWxTY3JvbGxiYXIiLCJzY3JvbGxiYXJzIiwiTkVWRVIiLCJlbmFibGVWZXJ0aWNhbFNjcm9sbGJhciIsIm11bHRpU2VsZWN0IiwiY29sdW1uRGVmcyIsImZpZWxkIiwiZW5hYmxlRmlsdGVyaW5nIiwib25SZWdpc3RlckFwaSIsImdyaWRBcGkiLCJzZWxlY3Rpb24iLCJvbiIsInJvd1NlbGVjdGlvbkNoYW5nZWQiLCJyb3ciLCJwYXRoIiwiZW50aXR5IiwiZm9ybWF0RGF0YSIsImdyb3VwIiwiYWdlcyIsInJlc3VsdCIsImZpbmQiLCJwYXJzZUludCIsImxnQWdlTWluIiwibGdBZ2VNYXgiLCJ0aW1lU3RyIiwibGdTdGFydFRpbWUiLCJzcGxpdCIsImxlbmd0aCIsImlkIiwiZGF5IiwibGdEYXkiLCJ0aW1lIiwidXRjIiwiZm9ybWF0IiwiY2FtcHVzIiwibGdJc09mZkNhbXB1cyIsInRpbWVTdGFtcCIsInRvRGF0ZSIsInNldEl0ZW0iLCJKU09OIiwic3RyaW5naWZ5IiwicGFyc2UiLCJkdXJhdGlvbiIsImRpZmYiLCJhc01pbnV0ZXMiLCJjb25zb2xlIiwibG9nIiwicmVtb3ZlSXRlbSIsImVycm9yIiwiJHJvdXRlUGFyYW1zIiwidG1wTGlmZWdyb3VwIiwibG9jYWxMaWZlZ3JvdXAiLCJsaWZlZ3JvdXAiLCJnZXRMaWZlZ3JvdXAiLCJuYXZpZ2F0ZUhvbWUiLCJsb2MiLCJkaXJlY3RpdmUiLCJyZXN0cmljdCJdLCJtYXBwaW5ncyI6IkNBQUEsV0FDQSxZQUVBLElBQUFBLEdBQUFDLFFBQUFDLE9BQUEsU0FDQSxZQUNBLGFBQ0EsYUFDQSxVQUNBLFVBQ0EscUJBR0FGLEdBQUFHLFFBQUEsaUJBQUEsU0FBQUMsR0FDQUEsRUFDQUMsS0FBQSxLQUNBQyxXQUFBLGlCQUNBQyxZQUFBLG1DQUVBRixLQUFBLG9CQUNBQyxXQUFBLHNCQUNBQyxZQUFBLDZDQUVBQyxXQUNBQyxXQUFBLFNBR0FDLE1BQUEsZUFBQUMsT0FBQUMsY0FDQUYsTUFBQSxTQUFBQyxPQUFBRSxRQUNBSCxNQUFBLElBQUFDLE9BQUFHLE1DNUJBLFdBQ0EsWUFFQWIsU0FBQUMsT0FBQSxTQUFBYSxTQUFBLFlBRUFDLFVBRUFDLElBQUEsRUFDQUMsSUFBQSxJQUNBQyxNQUFBLGFBR0FGLElBQUEsR0FDQUMsSUFBQSxHQUNBQyxNQUFBLGlCQ2RBLFdB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QkFBQSxTQUFBLFlBQUEsU0FBQWlDLEVBQUFDLEdBQ0FELEVBQUFBLFFBQUEsU0FBQW1FLEdBQ0FsRSxFQUFBeUIsS0FBQXlDLFVDTEEsV0FDQSxZQUVBekcsU0FBQUMsT0FBQSxTQUFBeUcsVUFBQSxnQkFBQSxXQUNBLE9BQ0FDLFNBQUEsSUFDQXJHLFlBQUEsc0NBQ0FELFdBQUEiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgdmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdsZ0FwcCcsIFtcclxuICAgICAgICAnbmdDb29raWVzJyxcclxuICAgICAgICAnbmdSZXNvdXJjZScsXHJcbiAgICAgICAgJ25nU2FuaXRpemUnLFxyXG4gICAgICAgICduZ1JvdXRlJyxcclxuICAgICAgICAndWkuZ3JpZCcsXHJcbiAgICAgICAgJ3VpLmdyaWQuc2VsZWN0aW9uJ1xyXG4gICAgXSk7XHJcblxyXG4gICAgYXBwLmNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyKSB7XHJcbiAgICAgICAgJHJvdXRlUHJvdmlkZXJcclxuICAgICAgICAgICAgLndoZW4oJy8nLCB7XHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnaG9tZUNvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL2hvbWUvaG9tZVRlbXBsYXRlLmh0bWwnXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC53aGVuKCcvbGlmZWdyb3VwLzpzbHVnJywge1xyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ2xpZmVncm91cENvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2R1bGVzL2xpZmVncm91cC9saWZlZ3JvdXBUZW1wbGF0ZS5odG1sJ1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAub3RoZXJ3aXNlKHtcclxuICAgICAgICAgICAgICAgIHJlZGlyZWN0VG86ICcvJ1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH1dKVxyXG4gICAgLnZhbHVlKCdsb2NhbFN0b3JhZ2UnLCB3aW5kb3cubG9jYWxTdG9yYWdlKVxyXG4gICAgLnZhbHVlKCdtb21lbnQnLCB3aW5kb3cubW9tZW50KVxyXG4gICAgLnZhbHVlKCdfJywgd2luZG93Ll8pO1xyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnbGdBcHAnKS5jb25zdGFudCgnbGdDb25maWcnLCB7XHJcbiAgICAgICAgLy8gbWluIGFuZCBtYXggbXVzdCBtYXRjaCBsZ0FnZU1pbiBhbmQgbGdBZ2VNYXggdmFsdWVzIGluIFdvcmRwcmVzcyBleGFjdGx5XHJcbiAgICAgICAgYWdlc0FycjogW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBtaW46IDAsXHJcbiAgICAgICAgICAgICAgICBtYXg6IDEwMCxcclxuICAgICAgICAgICAgICAgIHRpdGxlOiAnQWxsIEFnZXMnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG1pbjogMjAsXHJcbiAgICAgICAgICAgICAgICBtYXg6IDM5LFxyXG4gICAgICAgICAgICAgICAgdGl0bGU6ICcyMHMvMzBzJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXVxyXG4gICAgfSk7XHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2xnQXBwJykuc2VydmljZSgnbGdTZXJ2aWNlJywgWyckaHR0cCcsIGZ1bmN0aW9uICgkaHR0cCkge1xyXG4gICAgICAgIHZhciBiYXNlVXJsID0gJ2h0dHA6Ly9kYXl0b25hdmUub3JnL2FwaScsXHJcbiAgICAgICAgICAgIGN1cnJMaWZlZ3JvdXAgPSB7fTtcclxuXHJcbiAgICAgICAgdGhpcy5nZXRMaWZlZ3JvdXBzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgbGlmZWdyb3VwcyA9IFtdO1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KGJhc2VVcmwgKyAnL2dldF9wb3N0cy8/cG9zdF90eXBlPXBhZ2UnKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwYWdlcyA9IHJlcy5kYXRhO1xyXG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHBhZ2VzLnBvc3RzLCBmdW5jdGlvbiAocGFnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYWdlLmN1c3RvbV9maWVsZHMuaXNMaWZlZ3JvdXApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGlmZWdyb3Vwcy5wdXNoKHBhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGxpZmVncm91cHM7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuZ2V0TGlmZWdyb3VwQnlTbHVnID0gZnVuY3Rpb24gKHNsdWcpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldChiYXNlVXJsICsgJy9nZXRfcGFnZS8/c2x1Zz1saWZlZ3JvdXBzLycgKyBzbHVnKTtcclxuICAgICAgICB9O1xyXG4gICAgfV0pO1xyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCdsZ0FwcCcpLmNvbnRyb2xsZXIoJ2hvbWVDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJGxvY2F0aW9uJywgJ2xnU2VydmljZScsICd1aUdyaWRDb25zdGFudHMnLCAnbGdDb25maWcnLCAnbG9jYWxTdG9yYWdlJywgJ21vbWVudCcsIGZ1bmN0aW9uICgkc2NvcGUsICRsb2NhdGlvbiwgbGdTZXJ2aWNlLCB1aUdyaWRDb25zdGFudHMsIGxnQ29uZmlnLCBsb2NhbFN0b3JhZ2UsIG1vbWVudCkge1xyXG4gICAgICAgIHZhciB0bXBMaWZlZ3JvdXBzID0ge30sXHJcbiAgICAgICAgICAgIGxvY2FsTGlmZWdyb3VwcyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdsaWZlZ3JvdXBzJyk7XHJcblxyXG4gICAgICAgICRzY29wZS5saWZlZ3JvdXBzID0gW107XHJcbiAgICAgICAgJHNjb3BlLmNvbnRlbnRSZWFkeSA9IGZhbHNlO1xyXG5cclxuICAgICAgICAkc2NvcGUuZ3JpZE9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIGVuYWJsZVJvd1NlbGVjdGlvbjogdHJ1ZSxcclxuICAgICAgICAgICAgZW5hYmxlUm93SGVhZGVyU2VsZWN0aW9uOiBmYWxzZSxcclxuICAgICAgICAgICAgZW5hYmxlSG9yaXpvbnRhbFNjcm9sbGJhcjogdWlHcmlkQ29uc3RhbnRzLnNjcm9sbGJhcnMuTkVWRVIsXHJcbiAgICAgICAgICAgIGVuYWJsZVZlcnRpY2FsU2Nyb2xsYmFyOiB1aUdyaWRDb25zdGFudHMuc2Nyb2xsYmFycy5ORVZFUixcclxuICAgICAgICAgICAgbXVsdGlTZWxlY3Q6IGZhbHNlLFxyXG4gICAgICAgICAgICAvL2VuYWJsZUZpbHRlcmluZzogdHJ1ZSxcclxuICAgICAgICAgICAgY29sdW1uRGVmczogW1xyXG4gICAgICAgICAgICAgICAgeyBmaWVsZDogJ3RpdGxlJywgZW5hYmxlRmlsdGVyaW5nOiBmYWxzZSB9LFxyXG4gICAgICAgICAgICAgICAgeyBmaWVsZDogJ2FnZXMnLCBlbmFibGVGaWx0ZXJpbmc6IGZhbHNlIH0sXHJcbiAgICAgICAgICAgICAgICB7IGZpZWxkOiAnZGF5JywgZW5hYmxlRmlsdGVyaW5nOiBmYWxzZSB9LFxyXG4gICAgICAgICAgICAgICAgeyBmaWVsZDogJ3RpbWUnLCBlbmFibGVGaWx0ZXJpbmc6IGZhbHNlIH0sXHJcbiAgICAgICAgICAgICAgICB7IGZpZWxkOiAnY2FtcHVzJywgZW5hYmxlRmlsdGVyaW5nOiBmYWxzZSB9XHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgIGRhdGE6IFtdLFxyXG4gICAgICAgICAgICBvblJlZ2lzdGVyQXBpOiBmdW5jdGlvbiAoZ3JpZEFwaSkge1xyXG4gICAgICAgICAgICAgICAgLy9zZXQgZ3JpZEFwaSBvbiBzY29wZVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmdyaWRBcGkgPSBncmlkQXBpO1xyXG4gICAgICAgICAgICAgICAgZ3JpZEFwaS5zZWxlY3Rpb24ub24ucm93U2VsZWN0aW9uQ2hhbmdlZCgkc2NvcGUsIGZ1bmN0aW9uIChyb3cpIHtcclxuICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2xpZmVncm91cC8nICsgcm93LmVudGl0eS5zbHVnKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGZvcm1hdERhdGEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIF8uZm9yRWFjaCgkc2NvcGUubGlmZWdyb3VwcywgZnVuY3Rpb24gKGdyb3VwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYWdlcyA9IF8ucmVzdWx0KF8uZmluZChsZ0NvbmZpZy5hZ2VzQXJyLCB7ICdtaW4nOiBwYXJzZUludChncm91cC5jdXN0b21fZmllbGRzLmxnQWdlTWluKSwgJ21heCc6IHBhcnNlSW50KGdyb3VwLmN1c3RvbV9maWVsZHMubGdBZ2VNYXgpIH0pLCAndGl0bGUnKSxcclxuICAgICAgICAgICAgICAgICAgICB0aW1lU3RyID0gZ3JvdXAuY3VzdG9tX2ZpZWxkcy5sZ1N0YXJ0VGltZVswXS5zcGxpdCgnOicpWzBdLmxlbmd0aCA+IDEgPyAnMTk3MC0wMS0wMVQnICsgZ3JvdXAuY3VzdG9tX2ZpZWxkcy5sZ1N0YXJ0VGltZVswXSA6ICcxOTcwLTAxLTAxVDAnICsgZ3JvdXAuY3VzdG9tX2ZpZWxkcy5sZ1N0YXJ0VGltZVswXTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5ncmlkT3B0aW9ucy5kYXRhLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBncm91cC5pZCxcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZ3JvdXAudGl0bGUsXHJcbiAgICAgICAgICAgICAgICAgICAgYWdlczogYWdlcyxcclxuICAgICAgICAgICAgICAgICAgICBkYXk6IGdyb3VwLmN1c3RvbV9maWVsZHMubGdEYXlbMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgdGltZTogbW9tZW50LnV0Yyh0aW1lU3RyKS5mb3JtYXQoJ2g6bW1hJyksXHJcbiAgICAgICAgICAgICAgICAgICAgY2FtcHVzOiBncm91cC5jdXN0b21fZmllbGRzLmxnSXNPZmZDYW1wdXNbMF0gPT09ICd0cnVlJyA/ICdPZmYgQ2FtcHVzJyA6ICdPbiBDYW1wdXMnLFxyXG4gICAgICAgICAgICAgICAgICAgIHNsdWc6IGdyb3VwLnNsdWdcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0TGlmZWdyb3VwcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbGdTZXJ2aWNlLmdldExpZmVncm91cHMoKS50aGVuKGZ1bmN0aW9uIChsaWZlZ3JvdXBzKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubGlmZWdyb3VwcyA9IGxpZmVncm91cHM7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgICAgICAgICB0aW1lU3RhbXA6IG1vbWVudC51dGMoKS50b0RhdGUoKSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBsaWZlZ3JvdXBzXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2xpZmVncm91cHMnLCBKU09OLnN0cmluZ2lmeShkYXRhKSk7XHJcbiAgICAgICAgICAgICAgICBmb3JtYXREYXRhKCk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY29udGVudFJlYWR5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKGxvY2FsTGlmZWdyb3Vwcykge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgdG1wTGlmZWdyb3VwcyA9IEpTT04ucGFyc2UobG9jYWxMaWZlZ3JvdXBzKTtcclxuICAgICAgICAgICAgICAgIHZhciBkdXJhdGlvbiA9IG1vbWVudC51dGMoKS5kaWZmKG1vbWVudC51dGModG1wTGlmZWdyb3Vwcy50aW1lU3RhbXApKTtcclxuICAgICAgICAgICAgICAgIGlmIChtb21lbnQuZHVyYXRpb24oZHVyYXRpb24pLmFzTWludXRlcygpID4gMTUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTW9yZSB0aGFuIDE1IG1pbnV0ZXMgaGFzIHBhc3NlZCBzaW5jZSByZXRyaWV2aW5nIGRhdGEuIFJldHJpZXZlIGZyb20gQVBJIGluc3RlYWQuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2xpZmVncm91cHMnKTtcclxuICAgICAgICAgICAgICAgICAgICBnZXRMaWZlZ3JvdXBzKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5saWZlZ3JvdXBzID0gdG1wTGlmZWdyb3Vwcy5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdsaWZlZ3JvdXBzIHJldHJpZXZlZCBmcm9tIGxvY2FsIHN0b3JhZ2UnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvcm1hdERhdGEoKTtcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBwYXJzaW5nIGxpZmVncm91cHMuIFJldHJpZXZpbmcgZnJvbSBBUEknKTtcclxuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdsaWZlZ3JvdXBzJyk7XHJcbiAgICAgICAgICAgICAgICBnZXRMaWZlZ3JvdXBzKCk7XHJcbiAgICAgICAgICAgIH0gZmluYWxseSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY29udGVudFJlYWR5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdsaWZlZ3JvdXBzIHJldHJpZXZlZCBmcm9tIEFQSScpO1xyXG4gICAgICAgICAgICBnZXRMaWZlZ3JvdXBzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfV0pO1xyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCdsZ0FwcCcpLmNvbnRyb2xsZXIoJ2xpZmVncm91cENvbnRyb2xsZXInLCBbJyRzY29wZScsICckcm91dGVQYXJhbXMnLCAnJGxvY2F0aW9uJywgJ2xnU2VydmljZScsIGZ1bmN0aW9uICgkc2NvcGUsICRyb3V0ZVBhcmFtcywgJGxvY2F0aW9uLCBsZ1NlcnZpY2UpIHtcclxuICAgICAgICB2YXIgdG1wTGlmZWdyb3VwID0ge30sXHJcbiAgICAgICAgICAgIGxvY2FsTGlmZWdyb3VwID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCRyb3V0ZVBhcmFtcy5zbHVnKTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmxpZmVncm91cCA9IHt9O1xyXG4gICAgICAgICRzY29wZS5jb250ZW50UmVhZHkgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdmFyIGdldExpZmVncm91cCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbGdTZXJ2aWNlLmdldExpZmVncm91cEJ5U2x1Zygkcm91dGVQYXJhbXMuc2x1ZykudGhlbihmdW5jdGlvbiAobGlmZWdyb3VwKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubGlmZWdyb3VwID0gbGlmZWdyb3VwLmRhdGEucGFnZTtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRpbWVTdGFtcDogbW9tZW50LnV0YygpLnRvRGF0ZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGxpZmVncm91cFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgkcm91dGVQYXJhbXMuc2x1ZywgSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbnRlbnRSZWFkeSA9IHRydWU7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGlmIChsb2NhbExpZmVncm91cCkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgdG1wTGlmZWdyb3VwID0gSlNPTi5wYXJzZShsb2NhbExpZmVncm91cCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZHVyYXRpb24gPSBtb21lbnQudXRjKCkuZGlmZihtb21lbnQudXRjKHRtcExpZmVncm91cC50aW1lU3RhbXApKTtcclxuICAgICAgICAgICAgICAgIGlmIChtb21lbnQuZHVyYXRpb24oZHVyYXRpb24pLmFzTWludXRlcygpID4gMTUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTW9yZSB0aGFuIDE1IG1pbnV0ZXMgaGFzIHBhc3NlZCBzaW5jZSByZXRyaWV2aW5nIGRhdGEuIFJldHJpZXZlIGZyb20gQVBJIGluc3RlYWQuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCRyb3V0ZVBhcmFtcy5zbHVnKTtcclxuICAgICAgICAgICAgICAgICAgICBnZXRMaWZlZ3JvdXAoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxpZmVncm91cCA9IHRtcExpZmVncm91cC5kYXRhLmRhdGEucGFnZTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbGlmZWdyb3VwIHJldHJpZXZlZCBmcm9tIGxvY2FsIHN0b3JhZ2UnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBwYXJzaW5nIGxpZmVncm91cC4gUmV0cmlldmluZyBmcm9tIEFQSScpO1xyXG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCRyb3V0ZVBhcmFtcy5zbHVnKTtcclxuICAgICAgICAgICAgICAgIGdldExpZmVncm91cCgpO1xyXG4gICAgICAgICAgICB9IGZpbmFsbHkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbnRlbnRSZWFkeSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnbGlmZWdyb3VwIHJldHJpZXZlZCBmcm9tIEFQSScpO1xyXG4gICAgICAgICAgICBnZXRMaWZlZ3JvdXAoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS5uYXZpZ2F0ZUhvbWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XHJcbiAgICAgICAgfTtcclxuICAgIH1dKTtcclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnbGdBcHAnKS5jb250cm9sbGVyKCduYXZDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJGxvY2F0aW9uJywgZnVuY3Rpb24oJHNjb3BlLCAkbG9jYXRpb24pIHtcclxuICAgICAgICAkc2NvcGUuZ290byA9IGZ1bmN0aW9uKGxvYykge1xyXG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aChsb2MpO1xyXG4gICAgICAgIH07XHJcbiAgICB9XSk7XHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2xnQXBwJykuZGlyZWN0aXZlKCdsZ05hdmlnYXRpb24nLCBbZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbW9kdWxlcy9uYXZpZ2F0aW9uL25hdlRlbXBsYXRlLmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnbmF2Q29udHJvbGxlcidcclxuICAgICAgICB9O1xyXG4gICAgfV0pO1xyXG59KSgpO1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=